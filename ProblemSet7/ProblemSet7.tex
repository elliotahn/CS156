\documentclass[12pt]{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx,enumitem}
\usepackage{tikz,fancyhdr}
\usepackage[labelfont=bf]{caption}

\pagestyle{fancy}
\fancyhf{}
\chead{PROBLEM SET 7}
\rhead{Elliot Ahn}
\lhead{Machine Learning}
\rfoot{\thepage}

\setlength{\headheight}{15pt}
\renewcommand{\footrulewidth}{0.5pt}

\newcommand{\be}{\mathbf{e}}

\begin{document}

\begin{enumerate}[leftmargin=*]
\item (d)
\item (e)
\item (d)
\item (d)
\item (b)
\item (d) Clearly the expectation values for $\be_1$ and $\be_2$ are 0.5. The expectation value for $\be$ is 
\begin{align*}
\int_0^1 \int_0^1 d x_1 \, dx_2 \min (x_1, x_2) &= \int_0^1 \int_0^{x_1} dx_1 \, dx_2 \, x_2 + \int_0^1 \int_0^{x_2} dx_2 \, dx_1 \, x_1 \\
&= \int_0^1 dx_1 \, x_1^2 \qquad \text{integrands are same so we double} \\
&= \frac{1}{3}
\end{align*}
\item Let's measure the cross-validation for the constant model. If we leave out the point $(-1, 0)$, then the fit is $y = 1/2$ and the squared error is $1/4$. The same goes for leaving out $(1, 0)$. If we leave out $(\rho, 1)$, then our squared error is $1$ and the average cross-validation error is
\[ \frac{1}{3} \left( 1 + \frac{1}{4} + \frac{1}{4} \right) = \frac{1}{2} \]
We do the same thing for the linear case. If we leave out $(-1, 0)$, then the model is
\[ y = \frac{1}{1 - \rho} \left( 1 - x \right) \]
which gives a squared error of
\[ E_{\text{val}} = \frac{4}{(1 - \rho)^2}. \]
If we leave out $(\rho, 1)$, then the model is $y = 0$ and the squared error is $1$. If we leave out $(1, 0)$ then the model is
\[ y = \frac{1}{1 + \rho} (x + 1) \]
and the squared error is
\[ E_{\text{val}} = \frac{4}{(1 + \rho)^2} \]
so the cross-validation error is
\[ \frac{1}{3} \left[ 1 + \frac{4}{(1 - \rho)^2} + \frac{4}{(1 + \rho)^2} \right] \]
Thus, setting these cross-validation errors equal yields
\[ \frac{4}{(1 - \rho)^2} + \frac{4}{(1 + \rho)^2} = \frac{1}{2} \]
Simplifying to standard quadratic form gives
\[ \rho^4 - 18 \rho^2 - 15 = 0 \]
which gives the solution
\[ \rho = \sqrt{9 + 4 \sqrt 6}. \]
\item (c) 60 percent
\item (d) 62 percent
\item (b) Average of 3.8 support vectors per run.
\end{enumerate}

\end{document}